<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MBOM Advanced Grid System</title>

    <!-- AG-Grid CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community@31.0.1/styles/ag-grid.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community@31.0.1/styles/ag-theme-alpine-dark.css">

    <!-- Custom VS Code Dark Theme -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #1e1e1e;
            color: #cccccc;
            height: 100vh;
            overflow: hidden;
        }

        /* VS Code ÌÖåÎßà Ïª§Ïä§ÌÑ∞ÎßàÏù¥Ïßï */
        .ag-theme-alpine-dark {
            --ag-background-color: #1e1e1e;
            --ag-header-background-color: #2d2d30;
            --ag-odd-row-background-color: #252526;
            --ag-row-hover-color: #2a2d2e;
            --ag-selected-row-background-color: #094771;
            --ag-border-color: #3e3e42;
            --ag-header-foreground-color: #cccccc;
            --ag-foreground-color: #cccccc;
            --ag-secondary-foreground-color: #969696;
            --ag-input-focus-border-color: #007acc;
            --ag-range-selection-background-color: rgba(0, 122, 204, 0.2);
            --ag-header-column-separator-color: #3e3e42;
            --ag-header-column-resize-handle-color: #007acc;
        }

        .ag-theme-alpine-dark .ag-root-wrapper {
            border: 1px solid #3e3e42;
            border-radius: 0;
        }

        .ag-theme-alpine-dark .ag-header {
            border-bottom: 1px solid #3e3e42;
            font-size: 12px;
        }

        .ag-theme-alpine-dark .ag-row {
            border-bottom: 1px solid #2d2d30;
            font-size: 13px;
        }

        .ag-theme-alpine-dark .ag-cell {
            padding: 0 10px;
            line-height: 32px;
        }

        /* Ìà¥Î∞î Ïä§ÌÉÄÏùº */
        .toolbar {
            padding: 10px;
            background: #2d2d30;
            border-bottom: 1px solid #3e3e42;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .toolbar button {
            padding: 6px 12px;
            background: #007acc;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            transition: background 0.2s;
        }

        .toolbar button:hover {
            background: #005a9e;
        }

        .toolbar button.secondary {
            background: #5a5a5a;
        }

        .toolbar button.secondary:hover {
            background: #6e6e6e;
        }

        .toolbar select {
            background: #3c3c3c;
            color: #cccccc;
            border: 1px solid #3e3e42;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 13px;
        }

        .toolbar label {
            font-size: 12px;
            color: #969696;
        }

        .toolbar .status {
            margin-left: auto;
            color: #007acc;
            font-size: 12px;
        }

        /* Î©îÏù∏ Ïª®ÌÖåÏù¥ÎÑà */
        .grid-container {
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .grid-wrapper {
            flex: 1;
            overflow: hidden;
        }

        /* ÏÉÅÌÉúÎ≥Ñ ÏÉâÏÉÅ */
        .status-draft { background: #969696 !important; }
        .status-pending { background: #f39c12 !important; }
        .status-approved { background: #27ae60 !important; }
        .status-rejected { background: #e74c3c !important; }
        .status-review { background: #3498db !important; }

        /* Î†àÎ≤®Î≥Ñ Ïä§ÌÉÄÏùº */
        .level-highlight {
            background-color: #007acc !important;
            color: white !important;
            font-weight: bold !important;
        }

        /* ÏúÑÌóò ÌëúÏãú */
        .high-leadtime {
            color: #e74c3c !important;
            font-weight: bold !important;
        }
    </style>
</head>
<body>
    <div class="grid-container">
        <!-- Ìà¥Î∞î -->
        <div class="toolbar">
            <button onclick="addNewRow()">‚ûï Ìñâ Ï∂îÍ∞Ä</button>
            <button class="secondary" onclick="deleteSelectedRows()">üóëÔ∏è ÏÇ≠Ï†ú</button>
            <button class="secondary" onclick="exportToExcel()">üìä Excel ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
            <button class="secondary" onclick="expandAll()">üìÇ Î™®Îëê ÌéºÏπòÍ∏∞</button>
            <button class="secondary" onclick="collapseAll()">üìÅ Î™®Îëê Ï†ëÍ∏∞</button>

            <div style="margin-left: auto; display: flex; gap: 10px; align-items: center;">
                <label>Î†àÎ≤® Ïàò:</label>
                <select id="levelCount" onchange="updateLevelColumns(this.value)">
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5" selected>5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                </select>

                <span class="status" id="selectionStatus">0Í∞ú ÏÑ†ÌÉùÎê®</span>
            </div>
        </div>

        <!-- AG-Grid Container -->
        <div class="grid-wrapper">
            <div id="myGrid" class="ag-theme-alpine-dark" style="height: 100%;"></div>
        </div>
    </div>

    <!-- AG-Grid JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/ag-grid-community@31.0.1/dist/ag-grid-community.min.js"></script>

    <script>
        // Ï†ÑÏó≠ Î≥ÄÏàò
        let gridApi;
        let columnApi;
        let currentLevelCount = 5;

        // ÏÉòÌîå Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
        function generateSampleData() {
            return [
                {
                    id: 'ENGINE-ASM-001',
                    partNumber: 'ENGINE-ASM-001',
                    description: 'ÏóîÏßÑ Ïñ¥ÏÖàÎ∏îÎ¶¨',
                    level: 0,
                    customer: 'Hyundai',
                    vehicle: 'Genesis',
                    project: 'Genesis-2024MY',
                    quantity: 1,
                    unit: 'EA',
                    unitCost: 5000000,
                    currency: 'KRW',
                    supplier: 'Supplier A',
                    leadTime: 30,
                    status: 'approved',
                    material: 'Aluminum',
                    weight: 120.5,
                    workcenter: 'ENG-LINE-01',
                    createdDate: '2024-01-15',
                    createdBy: 'Admin',
                    children: [
                        {
                            id: 'CYL-HEAD-001',
                            partNumber: 'CYL-HEAD-001',
                            description: 'Ïã§Î¶∞Îçî Ìó§Îìú',
                            level: 1,
                            customer: 'Hyundai',
                            vehicle: 'Genesis',
                            project: 'Genesis-2024MY',
                            quantity: 1,
                            unit: 'EA',
                            unitCost: 800000,
                            currency: 'KRW',
                            supplier: 'Supplier B',
                            leadTime: 20,
                            status: 'approved',
                            material: 'Aluminum',
                            weight: 15.2,
                            workcenter: 'CYL-LINE-01',
                            createdDate: '2024-01-15',
                            createdBy: 'Admin',
                            children: [
                                {
                                    id: 'VALVE-INT-001',
                                    partNumber: 'VALVE-INT-001',
                                    description: 'Ìù°Í∏∞ Î∞∏Î∏å',
                                    level: 2,
                                    customer: 'Hyundai',
                                    vehicle: 'Genesis',
                                    project: 'Genesis-2024MY',
                                    quantity: 8,
                                    unit: 'EA',
                                    unitCost: 15000,
                                    currency: 'KRW',
                                    supplier: 'Supplier C',
                                    leadTime: 15,
                                    status: 'approved',
                                    material: 'Steel',
                                    weight: 0.08,
                                    workcenter: 'VALVE-LINE-01',
                                    createdDate: '2024-01-15',
                                    createdBy: 'Admin'
                                },
                                {
                                    id: 'VALVE-EXH-001',
                                    partNumber: 'VALVE-EXH-001',
                                    description: 'Î∞∞Í∏∞ Î∞∏Î∏å',
                                    level: 2,
                                    customer: 'Hyundai',
                                    vehicle: 'Genesis',
                                    project: 'Genesis-2024MY',
                                    quantity: 8,
                                    unit: 'EA',
                                    unitCost: 18000,
                                    currency: 'KRW',
                                    supplier: 'Supplier C',
                                    leadTime: 15,
                                    status: 'approved',
                                    material: 'Steel',
                                    weight: 0.09,
                                    workcenter: 'VALVE-LINE-02',
                                    createdDate: '2024-01-15',
                                    createdBy: 'Admin'
                                }
                            ]
                        },
                        {
                            id: 'CYL-BLOCK-001',
                            partNumber: 'CYL-BLOCK-001',
                            description: 'Ïã§Î¶∞Îçî Î∏îÎ°ù',
                            level: 1,
                            customer: 'Hyundai',
                            vehicle: 'Genesis',
                            project: 'Genesis-2024MY',
                            quantity: 1,
                            unit: 'EA',
                            unitCost: 1200000,
                            currency: 'KRW',
                            supplier: 'Supplier A',
                            leadTime: 25,
                            status: 'approved',
                            material: 'Cast Iron',
                            weight: 35.5,
                            workcenter: 'BLOCK-LINE-01',
                            createdDate: '2024-01-15',
                            createdBy: 'Admin',
                            children: [
                                {
                                    id: 'PISTON-001',
                                    partNumber: 'PISTON-001',
                                    description: 'ÌîºÏä§ÌÜ§',
                                    level: 2,
                                    customer: 'Hyundai',
                                    vehicle: 'Genesis',
                                    project: 'Genesis-2024MY',
                                    quantity: 4,
                                    unit: 'EA',
                                    unitCost: 45000,
                                    currency: 'KRW',
                                    supplier: 'Supplier D',
                                    leadTime: 18,
                                    status: 'approved',
                                    material: 'Aluminum',
                                    weight: 0.45,
                                    workcenter: 'PISTON-LINE-01',
                                    createdDate: '2024-01-15',
                                    createdBy: 'Admin'
                                }
                            ]
                        },
                        {
                            id: 'CRANKSHAFT-001',
                            partNumber: 'CRANKSHAFT-001',
                            description: 'ÌÅ¨Îû≠ÌÅ¨ÏÉ§ÌîÑÌä∏',
                            level: 1,
                            customer: 'Hyundai',
                            vehicle: 'Genesis',
                            project: 'Genesis-2024MY',
                            quantity: 1,
                            unit: 'EA',
                            unitCost: 650000,
                            currency: 'KRW',
                            supplier: 'Supplier E',
                            leadTime: 45,
                            status: 'pending',
                            material: 'Forged Steel',
                            weight: 18.5,
                            workcenter: 'CRANK-LINE-01',
                            createdDate: '2024-01-15',
                            createdBy: 'Admin'
                        }
                    ]
                },
                {
                    id: 'TRANS-ASM-001',
                    partNumber: 'TRANS-ASM-001',
                    description: 'Î≥ÄÏÜçÍ∏∞ Ïñ¥ÏÖàÎ∏îÎ¶¨',
                    level: 0,
                    customer: 'Hyundai',
                    vehicle: 'Genesis',
                    project: 'Genesis-2024MY',
                    quantity: 1,
                    unit: 'EA',
                    unitCost: 3500000,
                    currency: 'KRW',
                    supplier: 'Supplier F',
                    leadTime: 35,
                    status: 'approved',
                    material: 'Aluminum',
                    weight: 85.5,
                    workcenter: 'TRANS-LINE-01',
                    createdDate: '2024-01-15',
                    createdBy: 'Admin',
                    children: [
                        {
                            id: 'GEAR-SET-001',
                            partNumber: 'GEAR-SET-001',
                            description: 'Í∏∞Ïñ¥ ÏÑ∏Ìä∏',
                            level: 1,
                            customer: 'Hyundai',
                            vehicle: 'Genesis',
                            project: 'Genesis-2024MY',
                            quantity: 1,
                            unit: 'SET',
                            unitCost: 850000,
                            currency: 'KRW',
                            supplier: 'Supplier G',
                            leadTime: 22,
                            status: 'approved',
                            material: 'Steel',
                            weight: 12.3,
                            workcenter: 'GEAR-LINE-01',
                            createdDate: '2024-01-15',
                            createdBy: 'Admin'
                        }
                    ]
                }
            ];
        }

        // Î†àÎ≤® Ïª¨Îüº ÏÉùÏÑ±
        function getLevelColumns() {
            const columns = [];
            for (let i = 0; i <= currentLevelCount; i++) {
                columns.push({
                    headerName: `LEVEL ${i}`,
                    field: `level${i}`,
                    width: 120,
                    cellStyle: function(params) {
                        const level = params.data?.level || 0;
                        if (level === i) {
                            return {
                                backgroundColor: '#007acc',
                                color: 'white',
                                fontWeight: 'bold'
                            };
                        }
                        return null;
                    },
                    valueGetter: function(params) {
                        const level = params.data?.level || 0;
                        if (level === i) {
                            return params.data?.partNumber || '';
                        }
                        return '';
                    }
                });
            }
            return columns;
        }

        // Ïª¨Îüº Ï†ïÏùò
        function getColumnDefs() {
            return [
                // Ï≤¥ÌÅ¨Î∞ïÏä§
                {
                    headerCheckboxSelection: true,
                    checkboxSelection: true,
                    width: 50,
                    pinned: 'left'
                },
                // ÏàúÎ≤à
                {
                    headerName: 'ÏàúÎ≤à',
                    field: 'seq',
                    width: 70,
                    pinned: 'left',
                    editable: false,
                    valueGetter: 'node.rowIndex + 1',
                    cellStyle: { textAlign: 'center', color: '#969696' }
                },
                // Í≥†Í∞ùÏÇ¨
                {
                    headerName: 'Í≥†Í∞ùÏÇ¨',
                    field: 'customer',
                    width: 120,
                    pinned: 'left',
                    editable: true,
                    cellEditor: 'agSelectCellEditor',
                    cellEditorParams: {
                        values: ['Hyundai', 'KIA', 'GM', 'Renault', 'SsangYong', 'Mercedes-Benz', 'BMW', 'Volkswagen']
                    }
                },
                // Ï∞®Ï¢Ö
                {
                    headerName: 'Ï∞®Ï¢Ö',
                    field: 'vehicle',
                    width: 120,
                    pinned: 'left',
                    editable: true
                },
                // ÌîÑÎ°úÏ†ùÌä∏
                {
                    headerName: 'ÌîÑÎ°úÏ†ùÌä∏',
                    field: 'project',
                    width: 150,
                    pinned: 'left',
                    editable: true
                },
                // Î†àÎ≤® Ïª¨ÎüºÎì§
                ...getLevelColumns(),
                // ÌíàÎ≤à
                {
                    headerName: 'ÌíàÎ≤à',
                    field: 'partNumber',
                    width: 150,
                    editable: true
                },
                // ÌíàÎ™Ö
                {
                    headerName: 'ÌíàÎ™Ö',
                    field: 'description',
                    width: 200,
                    editable: true
                },
                // ÏàòÎüâ
                {
                    headerName: 'U/S ÏàòÎüâ',
                    field: 'quantity',
                    width: 100,
                    editable: true,
                    type: 'numericColumn',
                    cellStyle: { textAlign: 'right' },
                    valueFormatter: function(params) {
                        if (params.value == null) return '';
                        return params.value.toLocaleString();
                    }
                },
                // Îã®ÏúÑ
                {
                    headerName: 'Îã®ÏúÑ',
                    field: 'unit',
                    width: 80,
                    editable: true,
                    cellEditor: 'agSelectCellEditor',
                    cellEditorParams: {
                        values: ['EA', 'SET', 'KG', 'M', 'L', 'M2', 'M3']
                    }
                },
                // Ïû¨Ïßà
                {
                    headerName: 'Ïû¨Ïßà',
                    field: 'material',
                    width: 150,
                    editable: true
                },
                // Ï§ëÎüâ
                {
                    headerName: 'Ï§ëÎüâ',
                    field: 'weight',
                    width: 100,
                    editable: true,
                    type: 'numericColumn',
                    cellStyle: { textAlign: 'right' },
                    valueFormatter: function(params) {
                        if (params.value == null) return '';
                        return params.value + ' kg';
                    }
                },
                // Í≥µÍ∏âÏóÖÏ≤¥
                {
                    headerName: 'Í≥µÍ∏âÏóÖÏ≤¥',
                    field: 'supplier',
                    width: 150,
                    editable: true
                },
                // Îã®Í∞Ä
                {
                    headerName: 'Îã®Í∞Ä',
                    field: 'unitCost',
                    width: 120,
                    editable: true,
                    type: 'numericColumn',
                    cellStyle: { textAlign: 'right' },
                    valueFormatter: function(params) {
                        if (params.value == null) return '';
                        return new Intl.NumberFormat('ko-KR', {
                            style: 'currency',
                            currency: params.data?.currency || 'KRW'
                        }).format(params.value);
                    }
                },
                // Î¶¨ÎìúÌÉÄÏûÑ
                {
                    headerName: 'Î¶¨ÎìúÌÉÄÏûÑ',
                    field: 'leadTime',
                    width: 100,
                    editable: true,
                    type: 'numericColumn',
                    cellStyle: function(params) {
                        const leadTime = params.value || 0;
                        if (leadTime > 30) {
                            return { textAlign: 'right', color: '#e74c3c', fontWeight: 'bold' };
                        }
                        return { textAlign: 'right' };
                    },
                    valueFormatter: function(params) {
                        if (params.value == null) return '';
                        return params.value + 'Ïùº';
                    }
                },
                // ÏûëÏóÖÏû•
                {
                    headerName: 'ÏûëÏóÖÏû•',
                    field: 'workcenter',
                    width: 120,
                    editable: true
                },
                // ÏÉÅÌÉú
                {
                    headerName: 'ÏÉÅÌÉú',
                    field: 'status',
                    width: 100,
                    editable: true,
                    cellEditor: 'agSelectCellEditor',
                    cellEditorParams: {
                        values: ['draft', 'pending', 'approved', 'rejected', 'review']
                    },
                    cellStyle: function(params) {
                        const statusColors = {
                            draft: '#969696',
                            pending: '#f39c12',
                            approved: '#27ae60',
                            rejected: '#e74c3c',
                            review: '#3498db'
                        };
                        return {
                            backgroundColor: statusColors[params.value] || 'transparent',
                            color: 'white',
                            textAlign: 'center',
                            fontWeight: 'bold'
                        };
                    },
                    valueFormatter: function(params) {
                        const statusLabels = {
                            draft: 'ÏûëÏÑ±Ï§ë',
                            pending: 'ÎåÄÍ∏∞',
                            approved: 'ÏäπÏù∏',
                            rejected: 'Î∞òÎ†§',
                            review: 'Í≤ÄÌÜ†'
                        };
                        return statusLabels[params.value] || params.value;
                    }
                },
                // ÏÉùÏÑ±Ïùº
                {
                    headerName: 'ÏÉùÏÑ±Ïùº',
                    field: 'createdDate',
                    width: 120,
                    editable: false,
                    valueFormatter: function(params) {
                        if (!params.value) return '';
                        return params.value;
                    }
                },
                // ÏÉùÏÑ±Ïûê
                {
                    headerName: 'ÏÉùÏÑ±Ïûê',
                    field: 'createdBy',
                    width: 100,
                    editable: false
                }
            ];
        }

        // Tree Data Î≥ÄÌôò
        function convertToTreeData(items) {
            const convertItem = function(item, parentPath = []) {
                const path = [...parentPath, item.partNumber || item.id];
                const result = {
                    ...item,
                    orgHierarchy: path
                };

                if (item.children && item.children.length > 0) {
                    result.children = item.children.map(child => convertItem(child, path));
                }

                return result;
            };

            return items.map(item => convertItem(item));
        }

        // Grid Options
        const gridOptions = {
            columnDefs: getColumnDefs(),
            defaultColDef: {
                editable: true,
                sortable: true,
                filter: true,
                resizable: true,
                minWidth: 80
            },
            rowData: convertToTreeData(generateSampleData()),
            treeData: true,
            animateRows: true,
            groupDefaultExpanded: 1,
            getDataPath: function(data) {
                return data.orgHierarchy;
            },
            autoGroupColumnDef: {
                headerName: 'BOM Structure',
                minWidth: 350,
                pinned: 'left',
                cellRendererParams: {
                    suppressCount: true
                }
            },
            rowSelection: 'multiple',
            rowMultiSelectWithClick: true,
            onSelectionChanged: onSelectionChanged,
            onCellValueChanged: onCellValueChanged,
            getRowStyle: function(params) {
                if (params.data?.isModified) {
                    return { backgroundColor: 'rgba(243, 156, 18, 0.1)' };
                }
                return null;
            }
        };

        // ÏÑ†ÌÉù Î≥ÄÍ≤Ω Ïù¥Î≤§Ìä∏
        function onSelectionChanged(event) {
            const selectedRows = event.api.getSelectedRows();
            document.getElementById('selectionStatus').textContent = selectedRows.length + 'Í∞ú ÏÑ†ÌÉùÎê®';
        }

        // ÏÖÄ Í∞í Î≥ÄÍ≤Ω Ïù¥Î≤§Ìä∏
        function onCellValueChanged(event) {
            event.data.isModified = true;
            event.api.refreshCells({ rowNodes: [event.node], force: true });
            console.log('Cell value changed:', event);
        }

        // ÏÉà Ìñâ Ï∂îÍ∞Ä
        function addNewRow() {
            const newRow = {
                id: 'NEW-' + Date.now(),
                partNumber: 'NEW-PART-001',
                description: 'ÏÉà Î∂ÄÌíà',
                level: 0,
                customer: 'Hyundai',
                vehicle: 'Genesis',
                project: 'Genesis-2024MY',
                quantity: 1,
                unit: 'EA',
                status: 'draft',
                createdDate: new Date().toISOString().split('T')[0],
                createdBy: 'User',
                orgHierarchy: ['NEW-PART-001']
            };

            const currentData = [];
            gridApi.forEachNode(node => currentData.push(node.data));
            currentData.push(newRow);

            gridApi.setRowData(convertToTreeData(currentData));
            alert('ÏÉà ÌñâÏù¥ Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§');
        }

        // ÏÑ†ÌÉùÎêú Ìñâ ÏÇ≠Ï†ú
        function deleteSelectedRows() {
            const selectedNodes = gridApi.getSelectedNodes();
            if (selectedNodes.length === 0) {
                alert('ÏÇ≠Ï†úÌï† Ìï≠Î™©ÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî');
                return;
            }

            if (confirm(selectedNodes.length + 'Í∞ú Ìï≠Î™©ÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                const selectedIds = selectedNodes.map(node => node.data.id);
                const remainingData = [];

                gridApi.forEachNode(node => {
                    if (!selectedIds.includes(node.data.id)) {
                        remainingData.push(node.data);
                    }
                });

                gridApi.setRowData(convertToTreeData(remainingData));
                alert(selectedNodes.length + 'Í∞ú Ìï≠Î™©Ïù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§');
            }
        }

        // Excel ÎÇ¥Î≥¥ÎÇ¥Í∏∞
        function exportToExcel() {
            gridApi.exportDataAsCsv({
                fileName: 'MBOM_' + new Date().toISOString().split('T')[0] + '.csv'
            });
        }

        // Î™®Îëê ÌéºÏπòÍ∏∞
        function expandAll() {
            gridApi.expandAll();
        }

        // Î™®Îëê Ï†ëÍ∏∞
        function collapseAll() {
            gridApi.collapseAll();
        }

        // Î†àÎ≤® Ïª¨Îüº ÏóÖÎç∞Ïù¥Ìä∏
        function updateLevelColumns(levelCount) {
            currentLevelCount = parseInt(levelCount);
            gridApi.setColumnDefs(getColumnDefs());
        }

        // DOMÏù¥ Î°úÎìúÎêòÎ©¥ Í∑∏Î¶¨Îìú Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            const gridDiv = document.querySelector('#myGrid');
            gridApi = agGrid.createGrid(gridDiv, gridOptions);
        });
    </script>
</body>
</html>